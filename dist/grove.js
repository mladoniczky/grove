(()=>{"use strict";const t=function(){function t(e,r,n){if(void 0===n&&(n=!1),this._key=e,this._parent=r,this._children={},this._isEnd=!1,!(n||e&&"string"==typeof e))throw new Error("Parent key cannot be null, empty or not type of string!");if(!(n||r&&r instanceof t))throw new Error("Parent node cannot be null, empty or not class of TrieNode")}return Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._isEnd=!!t,this._data=t,this._isEnd||(this._word=void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"word",{get:function(){return this._word},set:function(t){this._word=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnd",{get:function(){return this._isEnd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),t.prototype.unlink=function(){this._parent=void 0,this._key=void 0},t.prototype.link=function(t,e){this._key=t,this._parent=e},t.prototype.hasChildren=function(){return Object.keys(this._children).length>0},t.prototype.deleteChild=function(t){this._children[t]&&(this._children[t].data=void 0,this._children[t].unlink(),delete this._children[t])},t.prototype.addChild=function(t,e){if(t&&e){var r=this._children[t];return this._children[t]=e,r}},t.prototype.hasChild=function(t){return!!this._children[t]},t}();!function(){function e(){this._root=new t("",null,!0),this._lastIndex=1}Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),e.prototype.insert=function(t,e){return this._insertWord(t,e,this._root,0)},e.prototype._insertWord=function(e,r,n,o){if(o===e.length)return n.word=e,n.data=r,!0;var i=e.charAt(o);return n.hasChild(i)||n.addChild(i,new t(i,n)),this._insertWord(e,r,n.children[i],o+1)},e.prototype.search=function(t){var e=this._searchNode(t,this._root,0);return e?e.data:void 0},e.prototype._searchNode=function(t,e,r){if(r===t.length)return e.isEnd?e:void 0;var n=t.charAt(r);return e.hasChild(n)?this._searchNode(t,e.children[n],r+1):void 0},e.prototype.delete=function(t){var e=this._searchNode(t,this._root,0);return!!e&&(e.hasChildren()?(e.data=void 0,!0):(this._deleteWord(e),!0))},e.prototype._deleteWord=function(t){if(t!==this._root){var e=t.parent;e.deleteChild(t.key),e.hasChildren()||this._deleteWord(e)}},e.prototype.update=function(t,e){var r=this._searchNode(t,this._root,0);if(!r)return!1;var n=r.data;return r.data=e,n},e.prototype.getDataNode=function(t){return this._searchNode(t,this._root,0)},e.prototype.getPath=function(t){var e=[];e.push(this._root);for(var r=1;r<=t.length;r++)e.push(this._searchNode(t.substring(0,r),this._root,0));return e}}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ncm92ZS8uL3NyYy90cmllL3RyaWUtbm9kZS50cyIsIndlYnBhY2s6Ly9ncm92ZS8uL3NyYy90cmllL1RyaWUudHMiXSwibmFtZXMiOlsiX2tleSIsIl9wYXJlbnQiLCJpc1Jvb3QiLCJfY2hpbGRyZW4iLCJfaXNFbmQiLCJFcnJvciIsIlRyaWVOb2RlIiwidGhpcyIsIl9kYXRhIiwidmFsdWUiLCJfd29yZCIsInVuZGVmaW5lZCIsInVubGluayIsImxpbmsiLCJrZXkiLCJwYXJlbnQiLCJoYXNDaGlsZHJlbiIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJkZWxldGVDaGlsZCIsImRhdGEiLCJhZGRDaGlsZCIsIm5vZGUiLCJvbGQiLCJoYXNDaGlsZCIsIl9yb290IiwiX2xhc3RJbmRleCIsImluc2VydCIsIndvcmQiLCJfaW5zZXJ0V29yZCIsImN1cnJlbnROb2RlIiwid29yZEluZGV4IiwiYyIsImNoYXJBdCIsImNoaWxkcmVuIiwic2VhcmNoIiwiX3NlYXJjaE5vZGUiLCJpc0VuZCIsImRlbGV0ZSIsIl9kZWxldGVXb3JkIiwidXBkYXRlIiwiZ2V0RGF0YU5vZGUiLCJnZXRQYXRoIiwicGF0aCIsInB1c2giLCJpIiwic3Vic3RyaW5nIl0sIm1hcHBpbmdzIjoiMkJBT0EsV0FhSSxXQUFvQkEsRUFBc0JDLEVBQXNCQyxHQUM1RCxRQUQ0RCxJQUFBQSxPQUFBLEdBQTVDLEtBQUFGLE9BQXNCLEtBQUFDLFVBWGxDLEtBQUFFLFVBQTBDLEdBRTFDLEtBQUFDLFFBQWtCLElBVWpCRixHQUFZRixHQUF3QixpQkFBVEEsR0FDNUIsTUFBTSxJQUFJSyxNQUFNLDJEQUNwQixLQUFLSCxHQUFZRCxHQUFhQSxhQUFtQkssR0FDN0MsTUFBTSxJQUFJRCxNQUFNLDhEQWtINUIsT0EzR0ksc0JBQUkscUJBQU0sQyxJQUFWLFdBQ0ksT0FBT0UsS0FBS04sUyxnQ0FPaEIsc0JBQUksdUJBQVEsQyxJQUFaLFdBQ0ksT0FBT00sS0FBS0osVyxnQ0FHaEIs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WXpCLEtBU3JCLFlBQUEwQixPQUFBLFNBQU9aLEVBQWNSLEdBQ2pCLElBQU1FLEVBQU9oQixLQUFLOEIsWUFBWVIsRUFBTXRCLEtBQUttQixNQUFPLEdBQ2hELElBQUtILEVBQ0QsT0FBTyxFQUVYLElBQU1DLEVBQU1ELEVBQUtGLEtBRWpCLE9BREFFLEVBQUtGLEtBQU9BLEVBQ0xHLEdBUVgsWUFBQWtCLFlBQUEsU0FBWWIsR0FDUixPQUFPdEIsS0FBSzhCLFlBQVlSLEVBQU10QixLQUFLbUIsTUFBTyxJQVE5QyxZQUFBaUIsUUFBQSxTQUFRZCxHQUNKLElBQU1lLEVBQU8sR0FDYkEsRUFBS0MsS0FBS3RDLEtBQUttQixPQUVmLElBQUssSUFBSW9CLEVBQUksRUFBR0EsR0FBS2pCLEVBQUtWLE9BQVEyQixJQUM5QkYsRUFBS0MsS0FBS3RDLEtBQUs4QixZQUFZUixFQUFLa0IsVUFBVSxFQUFHRCxHQUFJdkMsS0FBS21CLE1BQU8sSUFFakUsT0FBT2tCLEdBekpmLEkiLCJmaWxlIjoiZ3JvdmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTm9kZSBvZiBhIHRyaWUgZGF0YSBzdHJ1Y3R1cmUuXHJcbiAqIFRoZSBub2RlIGNhbiBiZSByb290IG9yIGFueSBvdGhlciBub2RlIGluIFRyaWUgZGF0YSBzdHJ1Y3R1cmUuXHJcbiAqIFRoZSBoYXMgYWNjZXNzIHRvIGl0cyBwYXJlbnQgYW5kIGFsbCBvZiBpdHMgY2hpbGRyZW4uXHJcbiAqIElmIHRoZSBub2RlIGlzIGluZGV4IG9mIHRoZSB3b3JkIGluc2VydGVkIGludG8gdGhlIFRyaWUgaXQgaGFzIGZsYWcgaXNFbmRPZldvcmxkIHNldCB0byB0cnVlIGFuZCB3b3JkIGlzIHNldCB0byB0aGUgaW5kZXhlZCB3b3JkLlxyXG4gKiBJZiB0aGUgbm9kZSBpcyB0aGUgZW5kIG9mIGEgd29yZCBpdCBjYW4gY29udGFpbiBzb21lIGFkZGl0aW9uYWwgaW5kZXggZGF0YS5cclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRyaWVOb2RlPFQ+IHtcclxuXHJcbiAgICBwcml2YXRlIF9jaGlsZHJlbjogeyBbazogc3RyaW5nXTogVHJpZU5vZGU8VD4gfSA9IHt9O1xyXG4gICAgcHJpdmF0ZSBfZGF0YTogVDtcclxuICAgIHByaXZhdGUgX2lzRW5kOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIF93b3JkOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvciBvZiBhIG5ldyBub2RlIG9mIFRyaWUgZGF0YSBzdHJ1Y3R1cmVcclxuICAgICAqIEBwYXJhbSBfa2V5IEluZGV4IGZvciB0aGlzIG5vZGUgaW4gaXRzIHBhcmVudCBub2RlXHJcbiAgICAgKiBAcGFyYW0gX3BhcmVudCBSZWZlcmVuY2UgdG8gdGhlIHBhcmVudCBub2RlXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc1Jvb3RdIEJvb2xlYW4gZmxhZyBvZiByb290IG5vZGUuIElmIHRoZSBub2RlIGlzIHJvb3QgaXQgaXMgbm90IGNoZWNrIGZvciBwYXJlbnRcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfa2V5OiBzdHJpbmcsIHByaXZhdGUgX3BhcmVudDogVHJpZU5vZGU8VD4sIGlzUm9vdDogYm9vbGVhbiA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCFpc1Jvb3QgJiYgKCFfa2V5IHx8IHR5cGVvZiBfa2V5ICE9PSAnc3RyaW5nJykpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmVudCBrZXkgY2Fubm90IGJlIG51bGwsIGVtcHR5IG9yIG5vdCB0eXBlIG9mIHN0cmluZyFcIik7XHJcbiAgICAgICAgaWYgKCFpc1Jvb3QgJiYgKCFfcGFyZW50IHx8ICEoX3BhcmVudCBpbnN0YW5jZW9mIFRyaWVOb2RlKSkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmVudCBub2RlIGNhbm5vdCBiZSBudWxsLCBlbXB0eSBvciBub3QgY2xhc3Mgb2YgVHJpZU5vZGVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgcGFyZW50IG9iamVjdCBjb25zaXN0aW5nIG9mIHRoZSBjaGlsZCBpbmRleCBhbmQgcGFyZW50IG5vZGUuXHJcbiAgICAgKiBAcmV0dXJucyB7VHJpZU5vZGV9XHJcbiAgICAgKi9cclxuICAgIGdldCBwYXJlbnQoKTogVHJpZU5vZGU8VD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgbWFwIG9mIGFsbCBub2RlJ3MgY2hpbGRyZW4uXHJcbiAgICAgKiBAcmV0dXJucyB7e318e1RyaWVOb2RlfX0gQ2hpbGQgaW5kZXggaXMgb25lIGNoYXJhY3RlciBvZiBhIGluc2VydGVkIHdvcmQgYW5kIHZhbHVlIGlzIGNoaWxkJ3Mgbm9kZSBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGdldCBjaGlsZHJlbigpOiB7IFtrOiBzdHJpbmddOiBUcmllTm9kZTxUPiB9IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGRhdGEoKTogVCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGUgaW5kZXhlZCBkYXRhIG9mIHRoZSBub2RlLlxyXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBJZiBkYXRhIGlzIHNldCB0byBzb21lIHZhbHVlIHRoZSBub2RlIGlzIGF1dG9tYXRpY2FsbHkgc2V0IGFzIHRoZSBlbmQgb2YgYSB3b3JkLiBJZiBkYXRhIGhhcyBmYWxzZSB2YWx1ZSBpbmRleGVkIHdvcmQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBub2RlLlxyXG4gICAgICovXHJcbiAgICBzZXQgZGF0YSh2YWx1ZTogVCkge1xyXG4gICAgICAgIHRoaXMuX2lzRW5kID0gISF2YWx1ZTtcclxuICAgICAgICB0aGlzLl9kYXRhID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pc0VuZClcclxuICAgICAgICAgICAgdGhpcy5fd29yZCA9IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgd29yZCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl93b3JkO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB3b3JkKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLl93b3JkID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlzRW5kKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0VuZDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQga2V5KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBwYXJlbnQgb2JqZWN0IGZyb20gdGhpcyBub2RlLlxyXG4gICAgICogSWYgdGhpcyBmdW5jdGlvbiBpcyBmaW5pc2hlZCBhbGwgcmVmZXJlbmNlIHRvIHRoaXMgbm9kZSBmcm9tIHRoZSBUcmllIHJvb3QgaXMgbG9zdC5cclxuICAgICAqL1xyXG4gICAgdW5saW5rKCkge1xyXG4gICAgICAgIHRoaXMuX3BhcmVudCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9rZXkgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMaW5rIHRoaXMgbm9kZSB3aXRoIG5ldyBwYXJlbnQgbm9kZS5cclxuICAgICAqIEBwYXJhbSBrZXkgSW5kZXggb2YgdGhpcyBub2RlIGluIHRoZSBuZXcgcGFyZW50XHJcbiAgICAgKiBAcGFyYW0gcGFyZW50IFJlZmVyZW5jZSB0byB0aGUgcGFyZW50IG5vZGVcclxuICAgICAqL1xyXG4gICAgbGluayhrZXk6IHN0cmluZywgcGFyZW50OiBUcmllTm9kZTxUPikge1xyXG4gICAgICAgIHRoaXMuX2tleSA9IGtleTtcclxuICAgICAgICB0aGlzLl9wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiB0aGUgbm9kZSBoYXMgYW55IGNoaWxkIG5vZGVzIGF0dGFjaGVkIHRvIGl0LlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgaGFzIGFueSBjaGlsZHJlbiwgb3RoZXJ3aXNlIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBoYXNDaGlsZHJlbigpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fY2hpbGRyZW4pLmxlbmd0aCA+IDA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgY2hpbGQgaW5kZXhlZCBieSB0aGUgcHJvdmlkZWQgY2hhcmFjdGVyLlxyXG4gICAgICogSWYgdGhlIGNoaWxkIGRvZXMgbm90IGV4aXN0cyBub3RoaW5nIGhhcHBlbnMuXHJcbiAgICAgKiBJZiB0aGUgY2hpbGQgZG9lcyBleGlzdHMsIHRoZSBjaGlsZCBub2RlIG9iamVjdCBpcyBkZWxldGVkLlxyXG4gICAgICogQHBhcmFtIGtleSBDaGlsZCBpbmRleFxyXG4gICAgICovXHJcbiAgICBkZWxldGVDaGlsZChrZXk6IHN0cmluZykge1xyXG4gICAgICAgIGlmICghdGhpcy5fY2hpbGRyZW5ba2V5XSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX2NoaWxkcmVuW2tleV0uZGF0YSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9jaGlsZHJlbltrZXldLnVubGluaygpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9jaGlsZHJlbltrZXldO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGEgY2hpbGQgdG8gdGhlIG5vZGUuXHJcbiAgICAgKiBJZiBhIGNoaWxkIGFscmVhZHkgZXhpc3RzIG9uIHRoZSBpbmRleCBpdCBpcyBvdmVycmlkZGVuIGJ5IHRoZSBuZXcgY2hpbGQuXHJcbiAgICAgKiBAcGFyYW0ga2V5XHJcbiAgICAgKiBAcGFyYW0ge1RyaWVOb2RlfSBub2RlXHJcbiAgICAgKiBAcmV0dXJucyB7VHJpZU5vZGV8dW5kZWZpbmVkfSBJZiBhIGNoaWxkIGlzIG92ZXJyaWRkZW4gdGhlIG9sZCBjaGlsZCBub2RlIGlzIHJldHVybiwgb3RoZXJ3aXNlIHVuZGVmaW5lZC5cclxuICAgICAqL1xyXG4gICAgYWRkQ2hpbGQoa2V5OiBzdHJpbmcsIG5vZGU6IFRyaWVOb2RlPFQ+KSB7XHJcbiAgICAgICAgaWYgKCFrZXkgfHwgIW5vZGUpXHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3Qgb2xkID0gdGhpcy5fY2hpbGRyZW5ba2V5XTtcclxuICAgICAgICB0aGlzLl9jaGlsZHJlbltrZXldID0gbm9kZTtcclxuICAgICAgICByZXR1cm4gb2xkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaXMgdGhlIG5vZGUgaGFzIGEgY2hpbGQgaW5kZXhlZCBieSB0aGUgcHJvdmlkZWQgY2hhcmFjdGVyLlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYSBjaGlsZCBleGlzdHMsIG90aGVyd2lzZSBmYWxzZS5cclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqL1xyXG4gICAgaGFzQ2hpbGQoa2V5OiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gISF0aGlzLl9jaGlsZHJlbltrZXldO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBUcmllTm9kZSBmcm9tIFwiLi90cmllLW5vZGVcIjtcclxuXHJcbi8qKlxyXG4gKiBUcmllIGRhdGEgc3RydWN0dXJlLlxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJpZTxUPiB7XHJcblxyXG4gICAgcHJpdmF0ZSBfcm9vdDogVHJpZU5vZGU8VD4gPSBuZXcgVHJpZU5vZGUoXCJcIiwgbnVsbCwgdHJ1ZSk7XHJcbiAgICBwcml2YXRlIF9sYXN0SW5kZXg6IG51bWJlciA9IDE7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgcm9vdCBub2RlIG9mIHRoZSBUcmllXHJcbiAgICAgKiBAcmV0dXJucyB7VHJpZU5vZGV9XHJcbiAgICAgKi9cclxuICAgIGdldCByb290KCk6IFRyaWVOb2RlPFQ+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcm9vdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEluc2VydCB3b3JkIHRvIHRoZSBUcmllIGFuZCBtYXAgZGF0YSBvbiB0aGUgd29yZC5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfXdvcmRcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fVtkYXRhXVxyXG4gICAgICovXHJcbiAgICBpbnNlcnQod29yZDogc3RyaW5nLCBkYXRhOiBUKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luc2VydFdvcmQod29yZCwgZGF0YSwgdGhpcy5fcm9vdCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9d29yZFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9ZGF0YVxyXG4gICAgICogQHBhcmFtIHtUcmllTm9kZX1jdXJyZW50Tm9kZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9d29yZEluZGV4XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9pbnNlcnRXb3JkKHdvcmQ6IHN0cmluZywgZGF0YTogVCwgY3VycmVudE5vZGU6IFRyaWVOb2RlPFQ+LCB3b3JkSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICh3b3JkSW5kZXggPT09IHdvcmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnROb2RlLndvcmQgPSB3b3JkO1xyXG4gICAgICAgICAgICBjdXJyZW50Tm9kZS5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYyA9IHdvcmQuY2hhckF0KHdvcmRJbmRleCk7XHJcbiAgICAgICAgaWYgKCFjdXJyZW50Tm9kZS5oYXNDaGlsZChjKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50Tm9kZS5hZGRDaGlsZChjLCBuZXcgVHJpZU5vZGUoYywgY3VycmVudE5vZGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luc2VydFdvcmQod29yZCwgZGF0YSwgY3VycmVudE5vZGUuY2hpbGRyZW5bY10sIHdvcmRJbmRleCArIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2VhcmNoaW5nIFRyaWUgZm9yIGRhdGEgaW5kZXhlZCBieSB0aGUgcHJvdmlkZWQgd29yZC5cclxuICAgICAqIElmIHRoZSB3b3JkIGlzIGluIHRoZSBUcmllIGEgZGF0YSBvYmplY3QgaXMgcmV0dXJuZWQuXHJcbiAgICAgKiBJZiB0aGUgd29yZCBpcyBub3QgZm91bmQgaW4gdGhlIFRyaWUgdW5kZWZpbmVkIGlzIHJldHVybmVkLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9d29yZFxyXG4gICAgICogQHJldHVybnMge09iamVjdCB8IG51bGx9XHJcbiAgICAgKi9cclxuICAgIHNlYXJjaCh3b3JkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCB0aGlzLl9yb290LCAwKTtcclxuICAgICAgICByZXR1cm4gIW5vZGUgPyB1bmRlZmluZWQgOiBub2RlLmRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgaW5kZXggbm9kZSBmb3IgdGhlIHdvcmQuXHJcbiAgICAgKiBJZiB0aGUgd29yZCBpcyBub3QgaW4gdGhlIFRyaWUgdW5kZWZpbmVkIGlzIHJldHVybmVkLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9d29yZFxyXG4gICAgICogQHBhcmFtIHtUcmllTm9kZX1jdXJyZW50Tm9kZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9d29yZEluZGV4XHJcbiAgICAgKiBAcmV0dXJucyB7VHJpZU5vZGUgfCBudWxsfVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfc2VhcmNoTm9kZSh3b3JkOiBzdHJpbmcsIGN1cnJlbnROb2RlOiBUcmllTm9kZTxUPiwgd29yZEluZGV4OiBudW1iZXIpOiBUcmllTm9kZTxUPiB7XHJcbiAgICAgICAgaWYgKHdvcmRJbmRleCA9PT0gd29yZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLmlzRW5kID8gY3VycmVudE5vZGUgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYyA9IHdvcmQuY2hhckF0KHdvcmRJbmRleCk7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLmhhc0NoaWxkKGMpID8gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCBjdXJyZW50Tm9kZS5jaGlsZHJlbltjXSwgd29yZEluZGV4ICsgMSkgOiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgd29yZCBmcm9tIHRoZSBUcmllLlxyXG4gICAgICogSWYgdGhlIHdvcmQgaXMgbm90IGluIHRoZSBUcmllIGZhbHNlIGlzIHJldHVybmVkIG90aGVyd2lzZSB0cnVlLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9d29yZFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGRlbGV0ZSh3b3JkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCB0aGlzLl9yb290LCAwKTtcclxuICAgICAgICBpZiAoIW5vZGUpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKG5vZGUuaGFzQ2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICBub2RlLmRhdGEgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fZGVsZXRlV29yZChub2RlKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge1RyaWVOb2RlfSBjdXJyZW50Tm9kZVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfZGVsZXRlV29yZChjdXJyZW50Tm9kZTogVHJpZU5vZGU8VD4pIHtcclxuICAgICAgICBpZiAoY3VycmVudE5vZGUgPT09IHRoaXMuX3Jvb3QpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBjb25zdCBwYXJlbnQgPSBjdXJyZW50Tm9kZS5wYXJlbnQ7XHJcblxyXG4gICAgICAgIHBhcmVudC5kZWxldGVDaGlsZChjdXJyZW50Tm9kZS5rZXkpO1xyXG4gICAgICAgIGlmIChwYXJlbnQuaGFzQ2hpbGRyZW4oKSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZVdvcmQocGFyZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gd29yZFxyXG4gICAgICogQHBhcmFtIHsqfSBkYXRhXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgdXBkYXRlKHdvcmQ6IHN0cmluZywgZGF0YTogVCkge1xyXG4gICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLl9zZWFyY2hOb2RlKHdvcmQsIHRoaXMuX3Jvb3QsIDApO1xyXG4gICAgICAgIGlmICghbm9kZSlcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBjb25zdCBvbGQgPSBub2RlLmRhdGE7XHJcbiAgICAgICAgbm9kZS5kYXRhID0gZGF0YTtcclxuICAgICAgICByZXR1cm4gb2xkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB3b3JkXHJcbiAgICAgKiBAcmV0dXJucyB7VHJpZU5vZGV9XHJcbiAgICAgKi9cclxuICAgIGdldERhdGFOb2RlKHdvcmQ6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZWFyY2hOb2RlKHdvcmQsIHRoaXMuX3Jvb3QsIDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB3b3JkXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8VHJpZU5vZGU+fVxyXG4gICAgICovXHJcbiAgICBnZXRQYXRoKHdvcmQ6IHN0cmluZyk6IEFycmF5PFRyaWVOb2RlPFQ+PiB7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IFtdO1xyXG4gICAgICAgIHBhdGgucHVzaCh0aGlzLl9yb290KTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gd29yZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBwYXRoLnB1c2godGhpcy5fc2VhcmNoTm9kZSh3b3JkLnN1YnN0cmluZygwLCBpKSwgdGhpcy5fcm9vdCwgMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9